(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8867,        274]
NotebookOptionsPosition[      8145,        254]
NotebookOutlinePosition[      8502,        270]
CellTagsIndexPosition[      8459,        267]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"rTransformMatrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Beta]x1_", ",", "\[Alpha]x1_", ",", "\[Mu]x1_", ",", "\[Beta]y1_", 
      ",", "\[Alpha]y1_", ",", "\[Mu]y1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\[Beta]x2_", ",", "\[Alpha]x2_", ",", "\[Mu]x2_", ",", "\[Beta]y2_", 
      ",", "\[Alpha]y2_", ",", "\[Mu]y2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SqrtBox[
        FractionBox["\[Beta]x2", "\[Beta]x1"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}], "+", 
         RowBox[{"\[Alpha]x1", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{
       SqrtBox[
        RowBox[{"\[Beta]x2", "*", "\[Beta]x1"}]], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}]}], ",", "0", ",", "0"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Alpha]x2", "*", "\[Alpha]x1"}]}], ")"}]}], 
         SqrtBox[
          RowBox[{"\[Beta]x2", "*", "\[Beta]x1"}]]], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]x1", "-", "\[Alpha]x2"}], 
         SqrtBox[
          RowBox[{"\[Beta]x2", "*", "\[Beta]x1"}]]], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}]}]}], ",", 
      RowBox[{
       SqrtBox[
        FractionBox["\[Beta]x1", "\[Beta]x2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}], "-", 
         RowBox[{"\[Alpha]x2", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Mu]x2", "-", "\[Mu]x1"}], "]"}]}]}], ")"}]}], ",", "0", 
      ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       SqrtBox[
        FractionBox["\[Beta]y2", "\[Beta]y1"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}], "+", 
         RowBox[{"\[Alpha]y1", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{
       SqrtBox[
        RowBox[{"\[Beta]y2", "*", "\[Beta]y1"}]], 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Alpha]y2", "*", "\[Alpha]y1"}]}], ")"}]}], 
         SqrtBox[
          RowBox[{"\[Beta]y2", "*", "\[Beta]y1"}]]], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]y1", "-", "\[Alpha]y2"}], 
         SqrtBox[
          RowBox[{"\[Beta]y2", "*", "\[Beta]y1"}]]], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}]}]}], ",", 
      RowBox[{
       SqrtBox[
        FractionBox["\[Beta]y1", "\[Beta]y2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}], "-", 
         RowBox[{"\[Alpha]y2", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Mu]y2", "-", "\[Mu]y1"}], "]"}]}]}], ")"}]}]}], "}"}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.738514542412705*^9, 3.738514578384882*^9}, {
  3.738514615575191*^9, 3.73851517670894*^9}, {3.738592801616435*^9, 
  3.738592834985228*^9}},ExpressionUUID->"027fd22c-14ac-49b7-8878-\
062ad4dc6876"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rTransformMatrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"7", ",", "8", ",", "9", ",", "1", ",", "2", ",", "3"}], "}"}]}],
    "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7385152654300737`*^9, 3.738515297746292*^9}, {
  3.738592843252866*^9, 
  3.738592843745422*^9}},ExpressionUUID->"47c67236-5da6-438a-86ce-\
494f27b4df13"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SqrtBox["7"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "6", "]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Sin", "[", "6", "]"}]}]}], ")"}]}], 
      RowBox[{
       SqrtBox["7"], " ", 
       RowBox[{"Sin", "[", "6", "]"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", "6", "]"}]}], 
         SqrtBox["7"]]}], "-", 
       FractionBox[
        RowBox[{"17", " ", 
         RowBox[{"Sin", "[", "6", "]"}]}], 
        SqrtBox["7"]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "6", "]"}], "-", 
        RowBox[{"8", " ", 
         RowBox[{"Sin", "[", "6", "]"}]}]}], 
       SqrtBox["7"]], "0", "0"},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "3", "]"}], "-", 
         RowBox[{"5", " ", 
          RowBox[{"Sin", "[", "3", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"Sin", "[", "3", "]"}]}]},
     {"0", "0", 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", "3", "]"}]}], "2"], "+", 
       FractionBox[
        RowBox[{"11", " ", 
         RowBox[{"Sin", "[", "3", "]"}]}], "2"]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "3", "]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Sin", "[", "3", "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.738515298991452*^9, {3.738592821012838*^9, 
   3.738592852761187*^9}},ExpressionUUID->"6d6f3755-17c7-467d-88da-\
10068434924e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.738515360442038*^9, 
  3.73851536164231*^9}},ExpressionUUID->"0686bccc-a3b7-4296-8c98-\
acdb4f2bd459"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "get", " ", "both", " ", "position", " ", "sets", " ", "of", " ", "6", " ",
     "from", " ", "madx", " ", "output", " ", "files"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"R1", " ", "=", " ", 
     RowBox[{"R", "[", 
      RowBox[{"TwissPos1", ",", "TwissPos2"}], "]"}]}], ";"}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{"for", " ", "first", " ", "optics", " ", "settings"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.738577261932591*^9, 3.7385774960155373`*^9}, {
  3.738579113260091*^9, 
  3.7385791223243027`*^9}},ExpressionUUID->"0481bd11-7ea0-41a3-babc-\
a09b55a066e0"]
},
WindowSize->{808, 702},
WindowMargins->{{3, Automatic}, {Automatic, 2}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3975, 115, 398, "Input",ExpressionUUID->"027fd22c-14ac-49b7-8878-062ad4dc6876"],
Cell[CellGroupData[{
Cell[4558, 139, 494, 13, 30, "Input",ExpressionUUID->"47c67236-5da6-438a-86ce-494f27b4df13"],
Cell[5055, 154, 2244, 72, 128, "Output",ExpressionUUID->"6d6f3755-17c7-467d-88da-10068434924e"]
}, Open  ]],
Cell[7314, 229, 151, 3, 30, "Input",ExpressionUUID->"0686bccc-a3b7-4296-8c98-acdb4f2bd459"],
Cell[7468, 234, 673, 18, 73, "Input",ExpressionUUID->"0481bd11-7ea0-41a3-babc-a09b55a066e0"]
}
]
*)

